{"version":3,"file":"index.mjs","sources":["../lib/main.js","../lib/ndarray.js","../lib/array.js"],"sourcesContent":["/**\n* @license Apache-2.0\n*\n* Copyright (c) 2022 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MODULES //\n\nimport isArrayLikeObject from '@stdlib/assert-is-array-like-object';\nimport isndarrayLike from '@stdlib/assert-is-ndarray-like';\nimport isFunction from '@stdlib/assert-is-function';\nimport ndarraylike2object from '@stdlib/ndarray-base-ndarraylike2object';\nimport arraylike2object from '@stdlib/array-base-arraylike2object';\nimport format from '@stdlib/error-tools-fmtprodmsg';\nimport ndarrayFcn from './ndarray.js';\nimport arrayFcn from './array.js';\n\n\n// MAIN //\n\n/**\n* Performs a map-reduce operation against each element in an array while iterating from right to left and returns the accumulated result.\n*\n* ## Notes\n*\n* -   The mapping function is provided the following arguments:\n*\n*     -   **value**: array element.\n*     -   **index**: element index.\n*     -   **arr**: input array.\n*\n* -   The reducing function is provided the following arguments:\n*\n*     -   **accumulator**: accumulated value.\n*     -   **value**: result of applying the mapping function against the current array element.\n*     -   **index**: element index.\n*     -   **arr**: input array.\n*\n* @param {(ArrayLikeObject|ndarray)} arr - input array\n* @param {*} initial - initial value\n* @param {Function} mapper - mapping function\n* @param {Function} reducer - reducing function\n* @param {*} [thisArg] - reduction function execution context\n* @throws {TypeError} first argument must be an array-like object or an ndarray\n* @throws {TypeError} third argument must be a function\n* @throws {TypeError} fourth argument must be a function\n* @returns {*} accumulated result\n*\n* @example\n* function square( value ) {\n*     return value * value;\n* }\n*\n* function sum( acc, value ) {\n*     return acc + value;\n* }\n*\n* var arr = [ 1, 2, 3, 4 ];\n*\n* var out = mapReduceRight( arr, 0, square, sum );\n* // returns 30\n*\n* @example\n* import naryFunction from '@stdlib/utils-nary-function';\n* import add from '@stdlib/math-base-ops-add';\n* import abs from '@stdlib/math-base-special-abs';\n* import array from '@stdlib/ndarray-array';\n*\n* var opts = {\n*     'dtype': 'generic'\n* };\n* var arr = array( [ [ -1, -2, -3 ], [ -4, -5, -6 ] ], opts );\n*\n* var out = mapReduceRight( arr, 0, naryFunction( abs, 1 ), naryFunction( add, 2 ) );\n* // returns 21\n*/\nfunction mapReduceRight( arr, initial, mapper, reducer, thisArg ) {\n\tif ( !isFunction( mapper ) ) {\n\t\tthrow new TypeError( format( '1VL3N,G4', mapper ) );\n\t}\n\tif ( !isFunction( reducer ) ) {\n\t\tthrow new TypeError( format( '1VL32,MM', reducer ) );\n\t}\n\tif ( isndarrayLike( arr ) ) { // note: assertion order matters here, as an ndarray-like object is also array-like\n\t\treturn ndarrayFcn( ndarraylike2object( arr ), initial, mapper, reducer, thisArg ); // eslint-disable-line max-len\n\t}\n\tif ( isArrayLikeObject( arr ) ) {\n\t\treturn arrayFcn( arraylike2object( arr ), initial, mapper, reducer, thisArg ); // eslint-disable-line max-len\n\t}\n\tthrow new TypeError( format( '1VLBH,O9', arr ) );\n}\n\n\n// EXPORTS //\n\nexport default mapReduceRight;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2022 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MODULES //\n\nimport vind2bind from '@stdlib/ndarray-base-vind2bind';\n\n\n// VARIABLES //\n\nvar MODE = 'throw';\n\n\n// MAIN //\n\n/**\n* Performs a map-reduce operation against each element in an array while iterating from right to left and returns the accumulated result.\n*\n* @private\n* @param {Object} x - object containing input ndarray meta data\n* @param {string} x.ref - reference to original input ndarray-like object\n* @param {string} x.dtype - data type\n* @param {Collection} x.data - data buffer\n* @param {NonNegativeInteger} x.length - number of elements\n* @param {NonNegativeIntegerArray} x.shape - dimensions\n* @param {IntegerArray} x.strides - stride lengths\n* @param {NonNegativeInteger} x.offset - index offset\n* @param {string} x.order - specifies whether `x` is row-major (C-style) or column-major (Fortran-style)\n* @param {Array<Function>} x.accessors - accessors for accessing data buffer elements\n* @param {*} initial - initial value\n* @param {Function} mapper - mapping function\n* @param {Function} reducer - reducing function\n* @param {*} thisArg - reducing function execution context\n* @returns {*} accumulated result\n*\n* @example\n* import Complex64Array from '@stdlib/array-complex64';\n* import Complex64 from '@stdlib/complex-float32';\n* import realf from '@stdlib/complex-realf';\n* import imagf from '@stdlib/complex-imagf';\n* import cceil from '@stdlib/math-base-special-cceil';\n* import cadd from '@stdlib/math-base-ops-cadd';\n* import naryFunction from '@stdlib/utils-nary-function';\n*\n* // Create a data buffer:\n* var xbuf = new Complex64Array( [ 1.5, 2.5, 3.5, 4.5, 5.5, 6.5, 7.5, 8.5 ] );\n*\n* // Define the shape of the input array:\n* var shape = [ 2, 2 ];\n*\n* // Define the array strides:\n* var sx = [ 2, 1 ];\n*\n* // Define the index offset:\n* var ox = 0;\n*\n* // Define a getter:\n* function getter( buf, idx ) {\n*     return buf.get( idx );\n* }\n*\n* // Create the input ndarray-like object:\n* var x = {\n*     'ref': null,\n*     'dtype': 'complex64',\n*     'data': xbuf,\n*     'length': 4,\n*     'shape': shape,\n*     'strides': sx,\n*     'offset': ox,\n*     'order': 'row-major',\n*     'accessors': [ getter ]\n* };\n* x.ref = x;\n*\n* // Compute the sum:\n* var v = mapReduceRight( x, new Complex64( 0.0, 0.0 ), naryFunction( cceil, 1 ), naryFunction( cadd, 2 ) );\n*\n* var re = realf( v );\n* // returns 20.0\n*\n* var im = imagf( v );\n* // returns 24.0\n*/\nfunction mapReduceRight( x, initial, mapper, reducer, thisArg ) {\n\tvar xbuf;\n\tvar ordx;\n\tvar acc;\n\tvar len;\n\tvar get;\n\tvar ref;\n\tvar shx;\n\tvar sx;\n\tvar ox;\n\tvar ix;\n\tvar i;\n\n\t// Cache the total number of elements over which to iterate:\n\tlen = x.length;\n\n\t// Cache the input array shape:\n\tshx = x.shape;\n\n\t// Cache reference to the input ndarray data buffer:\n\txbuf = x.data;\n\n\t// Cache reference to the stride array:\n\tsx = x.strides;\n\n\t// Cache the index of the first indexed element:\n\tox = x.offset;\n\n\t// Cache the array order:\n\tordx = x.order;\n\n\t// Cache the element accessor:\n\tget = x.accessors[ 0 ];\n\n\t// Cache the reference to the original input array:\n\tref = x.ref;\n\n\t// Check for a zero-dimensional array...\n\tif ( shx.length === 0 ) {\n\t\treturn reducer.call( thisArg, initial, mapper( get( xbuf, ox ), 0, ref ), 0, ref ); // eslint-disable-line max-len\n\t}\n\t// Iterate over each element based on the linear **view** index, regardless as to how the data is stored in memory (note: this has negative performance implications for non-contiguous ndarrays due to a lack of data locality)...\n\tacc = initial;\n\tfor ( i = len-1; i >= 0; i-- ) {\n\t\tix = vind2bind( shx, sx, ox, ordx, i, MODE );\n\t\tacc = reducer.call( thisArg, acc, mapper( get( xbuf, ix ), i, ref ), i, ref ); // eslint-disable-line max-len\n\t}\n\treturn acc;\n}\n\n\n// EXPORTS //\n\nexport default mapReduceRight;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2022 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MAIN //\n\n/**\n* Performs a map-reduce operation against each element in an array while iterating from right to left and returns the accumulated result.\n*\n* @private\n* @param {Object} x - object containing input array data\n* @param {ArrayLikeObject} x.data - input array data\n* @param {Array<Function>} x.accessors - input array accessors\n* @param {*} initial - initial value\n* @param {Function} mapper - mapping function\n* @param {Function} reducer - reducing function\n* @param {*} thisArg - reducing function execution context\n* @returns {*} accumulated result\n*\n* @example\n* function square( value ) {\n*     return value * value;\n* }\n*\n* function sum( acc, value ) {\n*     return acc + value;\n* }\n*\n* // Define a getter:\n* function getter( buf, idx ) {\n*     return buf[ idx ];\n* }\n*\n* // Create the input array object:\n* var x = {\n*     'data': [ 1, 2, 3, 4 ],\n*     'accessors': [ getter ]\n* };\n*\n* // Compute the sum of squared values:\n* var out = mapReduceRight( x, 0, square, sum );\n* // returns 30\n*/\nfunction mapReduceRight( x, initial, mapper, reducer, thisArg ) {\n\tvar xbuf;\n\tvar get;\n\tvar acc;\n\tvar i;\n\n\t// Cache reference to the input data:\n\txbuf = x.data;\n\n\t// Cache the element accessor:\n\tget = x.accessors[ 0 ];\n\n\t// Iterate over each element...\n\tacc = initial;\n\tfor ( i = xbuf.length-1; i >= 0; i-- ) {\n\t\tacc = reducer.call( thisArg, acc, mapper( get( xbuf, i ), i, xbuf ), i, xbuf ); // eslint-disable-line max-len\n\t}\n\treturn acc;\n}\n\n\n// EXPORTS //\n\nexport default mapReduceRight;\n"],"names":["mapReduceRight","arr","initial","mapper","reducer","thisArg","isFunction","TypeError","format","isndarrayLike","x","xbuf","ordx","acc","len","get","ref","shx","sx","ox","ix","i","length","shape","data","strides","offset","order","accessors","call","vind2bind","ndarrayFcn","ndarraylike2object","isArrayLikeObject","arrayFcn","arraylike2object"],"mappings":";;+qBA0FA,SAASA,EAAgBC,EAAKC,EAASC,EAAQC,EAASC,GACvD,IAAMC,EAAYH,GACjB,MAAM,IAAII,UAAWC,EAAQ,WAAYL,IAE1C,IAAMG,EAAYF,GACjB,MAAM,IAAIG,UAAWC,EAAQ,WAAYJ,IAE1C,GAAKK,EAAeR,GACnB,OCGF,SAAyBS,EAAGR,EAASC,EAAQC,EAASC,GACrD,IAAIM,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EA2BJ,GAxBAP,EAAMJ,EAAEY,OAGRL,EAAMP,EAAEa,MAGRZ,EAAOD,EAAEc,KAGTN,EAAKR,EAAEe,QAGPN,EAAKT,EAAEgB,OAGPd,EAAOF,EAAEiB,MAGTZ,EAAML,EAAEkB,UAAW,GAGnBZ,EAAMN,EAAEM,IAGY,IAAfC,EAAIK,OACR,OAAOlB,EAAQyB,KAAMxB,EAASH,EAASC,EAAQY,EAAKJ,EAAMQ,GAAM,EAAGH,GAAO,EAAGA,GAI9E,IADAH,EAAMX,EACAmB,EAAIP,EAAI,EAAGO,GAAK,EAAGA,IACxBD,EAAKU,EAAWb,EAAKC,EAAIC,EAAIP,EAAMS,EAtH1B,SAuHTR,EAAMT,EAAQyB,KAAMxB,EAASQ,EAAKV,EAAQY,EAAKJ,EAAMS,GAAMC,EAAGL,GAAOK,EAAGL,GAEzE,OAAOH,CACR,CDnDSkB,CAAYC,EAAoB/B,GAAOC,EAASC,EAAQC,EAASC,GAEzE,GAAK4B,EAAmBhC,GACvB,OE1CF,SAAyBS,EAAGR,EAASC,EAAQC,EAASC,GACrD,IAAIM,EACAI,EACAF,EACAQ,EAUJ,IAPAV,EAAOD,EAAEc,KAGTT,EAAML,EAAEkB,UAAW,GAGnBf,EAAMX,EACAmB,EAAIV,EAAKW,OAAO,EAAGD,GAAK,EAAGA,IAChCR,EAAMT,EAAQyB,KAAMxB,EAASQ,EAAKV,EAAQY,EAAKJ,EAAMU,GAAKA,EAAGV,GAAQU,EAAGV,GAEzE,OAAOE,CACR,CFwBSqB,CAAUC,EAAkBlC,GAAOC,EAASC,EAAQC,EAASC,GAErE,MAAM,IAAIE,UAAWC,EAAQ,WAAYP,GAC1C"}